<!DOCTYPE html>
<html lang="en">
<head>
  <title>Student List</title>

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
	<!--datatabel scripts-->
    
    <script src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.21/js/dataTables.bootstrap4.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.2.5/js/dataTables.responsive.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.2.5/js/responsive.bootstrap4.min.js"></script> 

    <style type="text/css">
    	input[type=text], select option, select  {
    		width: 100%;
		  padding: 12px 20px;
		  display: inline-block;
		  border: 1px solid #ccc;
		  border-radius: 4px;
		  box-sizing: border-box;
		  font-weight: bold;
    	}
    </style>


</head>
<body>
	<header class="container p-3 alert-success">
		<h3>SUBJECT</h3>
		<p>COURSE YEAR & SECTION</b></p>
	</header>
	<section class="container mt-4">
		<h4>List of Students</h4>
		<button type='button' class='btn btn-primary m-2' data-toggle='modal' data-target='#reg'>Add Student</button>

		
			<div class="container-fluid">
							
				<table id ="myTable"class="display" style="width:100%">
				    <thead>
				        <tr>
				            <th>IDNo</th>
				            <th>LastName</th>
				            <th>FirstName</th>
				            <th>MiddleName</th>
				            <th>Civil Status</th>
				            <th>Gender</th>
				            <th>Course</th>
				            <th>Action</th>
				        </tr>
				    </thead>
				    <tbody id="listhere" >

				    </tbody>
				</table>

		</div>

		<!-- Modal Form for Add Student--> 
<div class="modal fade" id="reg" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Register</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body" >
            <p class="text-danger">* Required Field</p>
           <form id="reg-form" class="form-group" enctype="multipart/form-data">
              <input type="hidden" name="studentID" value="0">
              <input type="hidden" name="saveID" value="0"> 
               <label for="lastname">Lastname<span class="text-danger">*</span></label>
               <input type="text" class="form-control" name="lastname" placeholder="Enter Lastname" required>
               <label for="firstname">Firstname<span class="text-danger">*</span></label>
               <input type="text" class="form-control" name="firstname" placeholder="Enter Firstname" required>
               <label for="middlename">Middlename<span class="text-danger">*</span></label>
               <input type="text" class="form-control" name="middlename" placeholder="Enter Middlename" required>
               <label for="course">Course</label>
               <input type="text" class="form-control" name="course" placeholder="Enter Course">
               <label for="gender">Gender</label>
               <select class="form-control" name="gender">
                <option value="">Enter Gender</option>
                <option value="Male">Male</option>
                <option value="Female">Female</option>
              </select>
               <label for="civilstatus">Civil Status</label>
               <select class="form-control" name="civilstatus">
                <option value="">Enter Civil Status</option>
                <option value="Single">Single</option>
                <option value="Married">Married</option>
              </select>
               <input type="hidden" name="saveID" value="0">
           
        </div>
        <div class="modal-footer">
                <input type="submit" class="btn btn-info" id="savestud" name="savestud">
            </form>
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

<!-- Modal Form for Edit Student--> 
		<div class="modal fade" id="edit_data_Modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
		  <div class="modal-dialog modal-lg">
		    <div class="modal-content">
		      <div class="modal-header">
		        <h5 class="modal-title" id="exampleModalLabel">Update Student Info</h5>
		        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
		          <span aria-hidden="true">&times;</span>
		        </button>
		      </div>
		      <div class="modal-body" >
		      	<p class="text-danger">* Required Field</p>
		         <form id="update-form" class="form-group" enctype="multipart/form-data">
					<label target="#StudentID">Student ID</label>
		         	<input  class="form-control mb-2" type="text" name="studentID" id="edit-studentID" readonly>
		         	<label target="#lastname">Lastname<span class="text-danger">*</span></label>
		         	<input type="text" class="form-control mb-2" name="lastname" id="edit-lastname" placeholder="Enter Lastname" required>
		         	<label>Firstname<span class="text-danger">*</span></label>
		         	<input type="text" class="form-control mb-2" name="firstname" id="edit-firstname" placeholder="Enter Firstname" required>
		         	<label>Middlename<span class="text-danger">*</span></label>
		         	<input type="text" class="form-control mb-2" name="middlename" id="edit-middlename" placeholder="Enter Middlename" required>
		         	<label>Course</label>
		         	<input type="text" class="form-control mb-2" name="course" id="edit-course" placeholder="Enter Course">
		         	<label>Gender</label>
		         	<select class="form-control" name="gender" id="edit-gender">
				      <option value="">Enter Gender</option>
				      <option value="Male">Male</option>
				      <option value="Female">Female</option>
				    </select>
		         	<label>Civil Status</label>
		         	<select class="form-control" name="civilstatus" id="edit-civilstatus">
				      <option value="">Enter Civil Status</option>
				      <option value="Single">Single</option>
				      <option value="Married">Married</option>
				    </select>
		         	<input type="hidden" name="saveID" value="1">
		         	

		         
		      </div>
		      <div class="modal-footer">
                <input type="submit" class="btn btn-info" id="edit-stud" name="edit-stud">
		      	</form>
		        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
		      </div>
		    </div>
		  </div>
		</div>

<!-- View modal -->
		<div class="modal fade" id="view_data_Modal" tabindex="-2" role="dialog" aria-labelledby="viewModalLabel" aria-hidden="true">
		  <div class="modal-dialog modal-lg">
		    <div class="modal-content">
		      <div class="modal-header">
		        <h5 class="modal-title" id="exampleModalLabel">Student Info</h5>
		        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
		          <span aria-hidden="true">&times;</span>
		        </button>
		      </div>
		      <div class="modal-body" >
		      	
		         <form id="update-form" class="form-group" enctype="multipart/form-data">
		         	<label target="#StudentID">Student ID</label>
		         	<input  class="form-control mb-2" type="text" name="studentID" id="view-studentID" readonly>
		         	<label target="#lastname">Lastname<span class="text-danger">*</span></label>
		         	<input type="text" class="form-control mb-2" name="lastname" id="view-lastname" readonly>
		         	<label>Firstname<span class="text-danger">*</span></label>
		         	<input type="text" class="form-control mb-2" name="firstname" id="view-firstname" readonly>
		         	<label>Middlename<span class="text-danger">*</span></label>
		         	<input type="text" class="form-control mb-2" name="middlename" id="view-middlename" readonly>
		         	<label>Course</label>
		         	<input type="text" class="form-control mb-2" name="course" id="view-course" readonly>
		         	<label>Gender</label>
		         	<input type="text" class="form-control mb-2" name="gender" id="view-gender" readonly>
		         	<label>Civil Status</label>
		         	<input type="text" class="form-control mb-2" name="gender" id="view-civilstatus" readonly>
		         	
		         	<input type="hidden" name="saveID" value="0">
		         	

		         
		      </div>
		      <div class="modal-footer">
		      	</form>
		        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
		      </div>
		    </div>
		  </div>
		</div>
	</section>


	<script>
		$(document).ready(function() {
		  $('#myTable').DataTable();
		});
		
	  
		// Load student list
		$(document).ready(function() {
		  $.ajax({
			type: "GET",
			url: "class-student.php", 
			success: function(data) {
			  $("#listhere").html(data);
			}
		  });
		});
	
		 // Add student form submission
		$(document).on("submit", "#reg-form", function(event) {
			event.preventDefault();
			var formData = $(this).serialize();
			$.ajax({
			url: "save-student.php", 
			method: "POST",
			data: formData,
			success: function(response) {
				$("#listhere").html(response);
				alert("New Student Saved");
				$("#reg-form")[0].reset();
				$("#reg").modal("hide");
			}
			});
		});

	  
		// Edit student form submission
		$(document).on('click', '.edit_data', function() {
			var studentID = $(this).attr('id'); // Get the student ID from the clicked button
			console.log(studentID);
			$.ajax({
				url: "view-student.php", 
				method: "POST",
				data: {
					studentID: studentID,
					saveID: 1 
				},
				dataType: "json",
				success: function(data) {
					console.log(data);
					$('#edit-studentID').val(data.id);
					$('#edit-lastname').val(data.lastname);
					$('#edit-firstname').val(data.firstname);
					$('#edit-middlename').val(data.middlename);
					$('#edit-course').val(data.course);
					$('#edit-gender').val(data.gender);
					$('#edit-civilstatus').val(data.civilstatus);
					$('#edit_data_Modal').modal('show'); 
				}
			});
		});

	  //View student modal
		$(document).on('click', '.view_data', function() {
			var studentID = $(this).attr('id');
			console.log("Clicked student ID:", studentID); 
		
			$.ajax({
				url: "view-student.php",
				method: "POST",
				data: {
					studentID: studentID,
					saveID: 1
				},
				dataType: "json",
				success: function(data) {
					console.log("Response data:", data); 
					$('#view-studentID').val(data.id);
					$('#view-lastname').val(data.lastname);
					$('#view-firstname').val(data.firstname);
					$('#view-middlename').val(data.middlename);
					$('#view-course').val(data.course);
					$('#view-gender').val(data.gender);
					$('#view-civilstatus').val(data.civilstatus);
					$('#view_data_Modal').modal('show');
				}
			});
		});
		

		
	  </script>
	  </body>
	  </html>